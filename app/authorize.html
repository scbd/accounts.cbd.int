<!DOCTYPE html>
<html lang="en">
<head>
<script>

function getCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');

    for(var i=0; i<ca.length; i++) {
        var c = ca[i].trim();
        if (c.indexOf(name)==0) return c.substring(name.length,c.length);
    }
    return "";
}

function setCookie(cname,cvalue,exdays)
{
    var d = new Date();
    d.setTime(d.getTime()+(exdays*24*60*60*1000));
    var expires = "expires="+d.toGMTString();
    document.cookie = cname + "=" + cvalue + "; " + expires + "; path=/";
}

function receiveMessage(event) {
    if(event.origin=='https://absch.cbd.int' || event.origin=='http://absch.infra.cbd.int' || event.origin=='http://localhost:2010') {
        
        var message = JSON.parse(event.data);

        if(message.type=='getAuthenticationToken') {
            var response = { type: 'authenticationToken', authenticationToken: getCookie('authenticationToken'), authenticationEmail: getCookie('email') };
            window.parent.postMessage(JSON.stringify(response), event.origin);
        }
        if(message.type=='setAuthenticationToken') {
            setCookie('authenticationToken', message.authenticationToken, 7);
            setCookie('email', message.authenticationEmail, 30);
        }
    }
}

window.addEventListener('message', receiveMessage, false);

</script>
<body>
</body>
</html>